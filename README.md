# 湖北工业大学力创RM战队通信协议

##### 参考湖南大学RoboMaster跃鹿战队2022-2023电控通用嵌入式框架，适用与basic_framework电控框架下的通信。

## 编译环境

- 1.Ubuntu 22.04 
- 2.Ros2 Humble

## 通信协议

### 一、串口配置

通信方式是串口，配置为波特率 921600，8 位数据位，1 位停止位，无硬件流控，无校验位。

### 二、数据帧说明

以下所有低位在前发送，数据长度可变。

1. 通信协议格式

   | 帧头                    | 数据ID         | 数据          | 帧尾                                |
   | ----------------------- | -------------- | ------------- | ----------------------------------- |
   | protocol_header(4-byte) | cmd_id(2-byte) | data (n-byte) | frame_tail(2-byte，CRC16，整包校验) |

2. 帧头详细定义

   | 帧头        | 偏移位置 | 字节大小 | 内容                          |
   | ----------- | -------- | -------- | ----------------------------- |
   | sof(CMD)    | 0        | 1        | 数据帧起始字节，固定值为 0xA5 |
   | data_length | 1        | 2        | 数据帧中 data 的长度          |
   | crc_check   | 3        | 1        | 帧头CRC校验                   |

3. cmd_id 命令码 ID 说明 **(字节偏移 4，字节大小 2)**

   | 命令码         | 数据段长度      | 功能说明 |
   | -------------- | --------------- | -------- |
   | 0x0001(可修改) | 2 byte (16-bit) | 视觉数据 |
   | .......        |                 |          |

4. 数据段data (n-byte)

5. 数据偏移位置字节大小内容flags_register6216位标志置位寄存器float_data84 * data_lengthfloat数据内容（4 * data_length-byte）

6. frame_tail(CRC16，整包校验)